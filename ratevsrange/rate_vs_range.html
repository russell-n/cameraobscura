<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Rate Vs Range Throughput Test &mdash; Camera Obscura 2014.04.01 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/spacelab/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2014.04.01',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Camera Obscura 2014.04.01 documentation" href="../index.html" />
    <link rel="up" title="Rate-Vs-Range" href="index.html" />
    <link rel="prev" title="cameraobscura.ratevsrange.main.run_configuration" href="api/cameraobscura.ratevsrange.main.run_configuration.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Camera Obscura</a>
        <span class="navbar-text navbar-version pull-left"><b>2014.04.01</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../documentation/user/index.html">User Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/developer/index.html">Developer Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">The Camera Obscura (Read Me)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../set_logger.html">The Log Setter</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../attenuators/index.html">Attenuators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../clients/index.html">Client Connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/index.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/index.html">Common Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hosts/index.html">Hosts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iperflexer/index.html">The Iperf Lexer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">RVR Plugin</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Rate-Vs-Range</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tests/index.html">Testing The Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html">Utility Modules</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Rate Vs Range Throughput Test</a><ul>
<li><a class="reference internal" href="#the-test-class">The Test Class</a><ul>
<li><a class="reference internal" href="#api">API</a><ul>
<li><a class="reference internal" href="#the-attributes">The Attributes</a></li>
<li><a class="reference internal" href="#the-methods">The Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#class-diagrams">Class Diagrams</a></li>
<li><a class="reference internal" href="#responsibilities">Responsibilities</a></li>
<li><a class="reference internal" href="#collaborators">Collaborators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-attenuate-signal-method">The attenuate_signal Method</a></li>
<li><a class="reference internal" href="#the-call-method">The Call Method</a><ul>
<li><a class="reference internal" href="#the-original-method">The Original Method</a></li>
<li><a class="reference internal" href="#the-newer-method">The Newer Method</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-runtest-method">The RunTest Method</a><ul>
<li><a class="reference internal" href="#paths">Paths</a><ul>
<li><a class="reference internal" href="#alternative-path-1-attenuator-error">Alternative Path 1 (Attenuator Error)</a></li>
<li><a class="reference internal" href="#alternative-path-2-no-iperf-result">Alternative Path 2 (no Iperf result)</a></li>
<li><a class="reference internal" href="#alternative-path-3-no-network-connection">Alternative Path 3 (No Network Connection)</a></li>
<li><a class="reference internal" href="#alternative-path-4-ping-never-succeeds">Alternative Path 4 (<cite>ping</cite> never succeeds)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#a-newer-model">A Newer Model</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="api/cameraobscura.ratevsrange.main.run_configuration.html" title="Previous Chapter: cameraobscura.ratevsrange.main.run_configuration"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; cameraobscura...</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/ratevsrange/rate_vs_range.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="rate-vs-range-throughput-test">
<h1>Rate Vs Range Throughput Test<a class="headerlink" href="#rate-vs-range-throughput-test" title="Permalink to this headline">¶</a></h1>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RateVSRangeEnum</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A holder of special constants for the Test method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">upstream</span> <span class="o">=</span> <span class="n">IperfConstants</span><span class="o">.</span><span class="n">up</span>
    <span class="n">downstream</span> <span class="o">=</span> <span class="n">IperfConstants</span><span class="o">.</span><span class="n">down</span>

    <span class="c1"># for the query</span>
    <span class="n">attenuation</span> <span class="o">=</span> <span class="s1">&#39;attenuation&#39;</span>
    <span class="n">dut_upstream</span> <span class="o">=</span> <span class="s2">&quot;DUT TX (upstream)&quot;</span>
    <span class="n">server_upstream</span> <span class="o">=</span> <span class="s2">&quot;Server RX (upstream)&quot;</span>
    <span class="n">dut_downstream</span> <span class="o">=</span> <span class="s1">&#39;DUT RX (downstream)&#39;</span>
    <span class="n">server_downstream</span> <span class="o">=</span> <span class="s1">&#39;Server TX (downstream)&#39;</span>
</pre></div>
</div>
<div class="section" id="the-test-class">
<span id="cameraobscura-automatedrvr-test"></span><h2>The Test Class<a class="headerlink" href="#the-test-class" title="Permalink to this headline">¶</a></h2>
<p>This class runs the Rate-Vs-Range Test.</p>
<div class="section" id="api">
<h3>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">Test</span></code></td>
<td></td>
</tr>
</tbody>
</table>
<div class="section" id="the-attributes">
<h4>The Attributes<a class="headerlink" href="#the-attributes" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.ping</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.attenuations</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.maximum_attenuation</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.configuration</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.dut</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.server</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.iperf</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.attenuator</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.result_location</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.dump</span></code></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-methods">
<h4>The Methods<a class="headerlink" href="#the-methods" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.save_configuration</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.connected</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.get_querier</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.__call__</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.RunTest</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RateVsRangeTest.reset</span></code></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="class-diagrams">
<h3>Class Diagrams<a class="headerlink" href="#class-diagrams" title="Permalink to this headline">¶</a></h3>
<p>This is an idealized Diagram.</p>
<p class="plantuml">
<img src="../_images/plantuml-7cc1678cc2f2ca051dd90b40d2c7f9142a9e8a73.png" alt="RateVsRangeTest : __init__(configuration)
RateVsRangeTest: Hosts.HostSSH dut
RateVsRangeTest : Hosts.HostSSH server
RateVsRangeTest : Attenuator attenuator
RateVsRangeTest : logging.Logger logger
RateVsRangeTest: String result_location
RateVsRangeTest : (Boolean, String) __call__()
RateVsRangeTest: (Boolean, String) RunTest(String direction)
RateVsRangeTest o- RVRConfiguration
RateVsRangeTest o- Hosts.HostSSH
RateVsRangeTest o- SerialUtils.Utils
RateVsRangeTest o- GenericUtils.Utils
RateVsRangeTest o- Attenuator.AttenuatorFactory
RateVsRangeTest o- Attenuator.Attenuator
RateVsRangeTest o- RVRConfiguration
RateVsRangeTest o- Query" />
</p>
</div>
<div class="section" id="responsibilities">
<h3>Responsibilities<a class="headerlink" href="#responsibilities" title="Permalink to this headline">¶</a></h3>
<p>Right now:</p>
<blockquote>
<div><ul class="simple">
<li>Get values from the configuration</li>
<li>Build connections to the server and dut</li>
<li>Build aggregated objects</li>
<li>Get, timestamp, and maintain output folder path</li>
<li>Run the Iperf-test</li>
<li>Get and save rss values</li>
<li>Create and save csv-file from Iperf final values (raw-data is being discarded!)</li>
<li>Copies any configuration files it finds</li>
<li>Runs pings between client and server to test connectivity</li>
<li>Sets Attenuator attentuation</li>
<li>Tries to discover if an SSH connection is dead</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="collaborators">
<h3>Collaborators<a class="headerlink" href="#collaborators" title="Permalink to this headline">¶</a></h3>
<p>From this package:</p>
<blockquote>
<div><ul class="simple">
<li>SimpleClient, TelnetClient</li>
<li>TheHost</li>
<li>Attenuator.AttenuatorFactory</li>
<li>Attenuator.Attenuator</li>
<li>query.Query</li>
<li>Ping</li>
<li>StepIterator</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="the-attenuate-signal-method">
<span id="automatedrvr-attenuate-signal"></span><h2>The attenuate_signal Method<a class="headerlink" href="#the-attenuate-signal-method" title="Permalink to this headline">¶</a></h2>
<p>This doesn&#8217;t do much but call the Attenuator, but since there are so many sub-modules I&#8217;m moving it out to make it easier to test.</p>
</div>
<div class="section" id="the-call-method">
<span id="automated-rvr-test-runtest"></span><h2>The Call Method<a class="headerlink" href="#the-call-method" title="Permalink to this headline">¶</a></h2>
<p>Not to be confused with <code class="docutils literal"><span class="pre">RunTest</span></code> this is what calls <code class="docutils literal"><span class="pre">RunTest</span></code>.</p>
<div class="section" id="the-original-method">
<h3>The Original Method<a class="headerlink" href="#the-original-method" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" id="id1">
<img src="../_images/run_test_old.svg" /><p class="caption"><span class="caption-text">This is the original (more or less) method&#8217;s activity diagram.</span></p>
</div>
</div>
<div class="section" id="the-newer-method">
<h3>The Newer Method<a class="headerlink" href="#the-newer-method" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" id="id2">
<img src="../_images/run_test_new.svg" /><p class="caption"><span class="caption-text">This is the proposed activity diagram.</span></p>
</div>
</div>
</div>
<div class="section" id="the-runtest-method">
<span id="automated-rvr-test-underscore-runtest"></span><h2>The RunTest Method<a class="headerlink" href="#the-runtest-method" title="Permalink to this headline">¶</a></h2>
<p>The RunTest Method is the method that actually runs the test (RunTest is mostly sets things up and tears things down).</p>
<div class="section" id="paths">
<h3>Paths<a class="headerlink" href="#paths" title="Permalink to this headline">¶</a></h3>
<p>This is the proposed main path.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Get Attenuator Configuration</li>
<li>Reset the Attenuator</li>
<li>Run the RateVsRangeTest<ol class="arabic">
<li>Check the network connection</li>
<li>Record the DUT state</li>
<li>Run the test (Iperf)</li>
<li>Attenuate the signal</li>
</ol>
</li>
<li>Reset the Attenuator</li>
</ol>
</div></blockquote>
<div class="section" id="alternative-path-1-attenuator-error">
<h4>Alternative Path 1 (Attenuator Error)<a class="headerlink" href="#alternative-path-1-attenuator-error" title="Permalink to this headline">¶</a></h4>
<p>There are four points where the attenuator is called. This is a fatal error which will raise a <span class="xref std std-ref">RateVsRangeTestsuiteError</span>.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Attenuate</li>
<li>Catch <cite>AttenuatorError</cite></li>
<li>Log error</li>
<li>Raise <cite>RateVsRangeTestError</cite></li>
</ol>
</div></blockquote>
</div>
<div class="section" id="alternative-path-2-no-iperf-result">
<h4>Alternative Path 2 (no Iperf result)<a class="headerlink" href="#alternative-path-2-no-iperf-result" title="Permalink to this headline">¶</a></h4>
<p>The current <cite>utils.RunIperfTraffic</cite> method doesn&#8217;t raise errors but instead returns <cite>result</cite> as False (or possibly None). This needs to be changed but for now that&#8217;s how it is. The original implementation treated this the same as an AttenuatorError, quitting the method, but this causes it to skip the Attenuator reset at the end of the method. The proposed change is to instead break out of the loop and let the cleanup happen. The assumption is that the failure was caused by the attenuation of the signal and not anything inherent in the code.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Run RunIperfTraffic</li>
<li>Check <cite>result</cite> and find it False</li>
<li>Log the event</li>
<li>break out of loop</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="alternative-path-3-no-network-connection">
<h4>Alternative Path 3 (No Network Connection)<a class="headerlink" href="#alternative-path-3-no-network-connection" title="Permalink to this headline">¶</a></h4>
<p>The sentinel condition for the While Loop is based on the attenuation setting. There is also a network check (ping) being done (this is optional, but run by default). It was introduced when it was discovered that some devices hang when iperf can&#8217;t run traffic but still maintains a connection (edge-network conditions). It was made optional when a vendor informed us that they didn&#8217;t implement (a working) ping on their device. Since this is considered simply the case that the signal has been attenuated beyond what the device(s) can use it is treated as a normal occurrence and simply break out of the loop.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>In the original code this was one of the main failure points in the code as the output of <cite>ping</cite> on different devices changed enough that the screen-scraping would fail even though the ping succeeded. The proposed fix is the path that follows this one (Path 4).</p>
<ol class="last arabic simple">
<li>Check network connection</li>
<li>Fail to ping successfully</li>
<li>Log the events</li>
<li>break from the loop</li>
</ol>
</div>
</div>
<div class="section" id="alternative-path-4-ping-never-succeeds">
<h4>Alternative Path 4 (<cite>ping</cite> never succeeds)<a class="headerlink" href="#alternative-path-4-ping-never-succeeds" title="Permalink to this headline">¶</a></h4>
<p>Since the <cite>ping</cite> check has proven so fragile this is meant to make it more obvious where the failure occurred.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Check Network Connection</li>
<li>Fail to ping successfully</li>
<li>Log the event</li>
<li>Compare current attenuation and start attenuation</li>
<li>If current = start log error and raise CameraobscuraError</li>
</ol>
</div></blockquote>
<div class="figure align-center">
<img src="../_images/run_test_activity_diagram1.svg" /></div>
</div>
</div>
</div>
<div class="section" id="a-newer-model">
<h2>A Newer Model<a class="headerlink" href="#a-newer-model" title="Permalink to this headline">¶</a></h2>
<p>The previous figure was based on an initial simplification of the original code. On looking at it I realized that it didn&#8217;t necessarily make sense to reset the attenuator before and after the loop, so I simplified it once more.</p>
<div class="figure align-center">
<img src="../_images/run_test_activity_diagram_2.svg" /></div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, russelln.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>